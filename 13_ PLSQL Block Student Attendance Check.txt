
13

Procedure

Consider table Student (Roll, Name, Attendance ,Status)
Write a PL/SQL block for following requirements and handle the exceptions. Roll no. of students will be entered by the user. Attendance of roll no. entered by user will be checked in the Stud table. If attendance is less than 75% then display the message “Term not granted” and set the status in stud table as “Detained”. Otherwise display message “Term granted” and set the status in stud table as “Not Detained”


------




DECLARE
    v_roll_no Student.Roll%TYPE := '&Enter_Roll_No'; -- Accept user input
    v_attendance Student.Attendance%TYPE;
    e_low_attendance EXCEPTION;
BEGIN
    -- Get attendance
    SELECT Attendance INTO v_attendance
    FROM Student
    WHERE Roll = v_roll_no;

    -- Check attendance condition
    IF v_attendance < 75 THEN
        RAISE e_low_attendance;
    ELSE
        -- Term granted
        UPDATE Student
        SET Status = 'Not Detained'
        WHERE Roll = v_roll_no;
        DBMS_OUTPUT.PUT_LINE('Term granted. Status set to Not Detained.');
    END IF;

    COMMIT;

EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('Error: Roll number ' || v_roll_no || ' not found.');
    WHEN e_low_attendance THEN
        -- Term not granted (User-defined exception handler)
        UPDATE Student
        SET Status = 'Detained'
        WHERE Roll = v_roll_no;
        DBMS_OUTPUT.PUT_LINE('Term not granted. Status set to Detained.');
        COMMIT;
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('An unexpected error occurred: ' || SQLERRM);
END;
/


